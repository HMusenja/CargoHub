### Login
POST http://localhost:5000/api/users/login
Content-Type: application/json

{
  "email": "admin@mail.com",
  "password": "1234"
}


### OK: legacy type accepted ‚Üí maps to PICKED_UP
POST http://localhost:5000/api/scan
Content-Type: application/json

{
  "ref": "SHP-20251001-0005",
  "type": "INTAKE",
  "location": "HH-DE/Intake Zone A",
  "note": "Received at counter A-3"
}

### OK: canonical status
POST http://localhost:5000/api/scan
Content-Type: application/json

{
  "ref": "SHP-20251001-0005",
  "status": "AT_HUB",
  "location": { "city": "Hamburg", "country": "DE" }
}

### ERROR: unsupported
POST http://localhost:5000/api/scan
Content-Type: application/json

{
  "ref": "SHP-20251001-0005",
  "type": "FOO_STATE"
}


@baseUrl = http://localhost:5000
@contentType = application/json

### 1Ô∏è‚É£ LOGIN as staff (adjust route if yours differs)
POST {{baseUrl}}/api/auth/login
Content-Type: {{contentType}}

{
  "identifier": "staff@cargohub.test",
  "password": "Password!23"
}

> {% client.global.set("cookie", response.headers["set-cookie"][0]); %}


### 2Ô∏è‚É£ Fetch current shipments (queue check)
GET {{baseUrl}}/api/shipments?status=BOOKED
Cookie: {{cookie}}


### 3Ô∏è‚É£ Scan #1 ‚Äî BOOKED ‚Üí PICKED_UP (legacy type ‚ÄúINTAKE‚Äù)
POST {{baseUrl}}/api/scan
Content-Type: {{contentType}}
Cookie: {{cookie}}

{
  "ref": "SHP-20251002-0003",
  "type": "INTAKE",
  "location": "HH-DE/Intake Zone A",
  "note": "Received at counter"
}


### 4Ô∏è‚É£ Scan #2 ‚Äî PICKED_UP ‚Üí IN_TRANSIT
POST {{baseUrl}}/api/scan
Content-Type: {{contentType}}
Cookie: {{cookie}}

{
  "ref": "SHP-20251002-0003",
  "status": "IN_TRANSIT",
  "location": { "city": "Hamburg", "country": "DE" },
  "note": "Loaded on truck"
}


### 5Ô∏è‚É£ Scan #3 ‚Äî IN_TRANSIT ‚Üí AT_HUB
POST {{baseUrl}}/api/scan
Content-Type: {{contentType}}
Cookie: {{cookie}}

{
  "ref": "SHP-20251002-0003",
  "status": "AT_HUB",
  "location": "Hamburg/Hub A",
  "note": "Arrived at Hub"
}


### 6Ô∏è‚É£ Scan #4 ‚Äî AT_HUB ‚Üí OUT_FOR_DELIVERY
POST {{baseUrl}}/api/scan
Content-Type: {{contentType}}
Cookie: {{cookie}}

{
  "ref": "SHP-20251002-0003",
  "status": "OUT_FOR_DELIVERY",
  "location": "Dakar/Depot B",
  "note": "Driver assigned"
}


### 7Ô∏è‚É£ Scan #5 ‚Äî OUT_FOR_DELIVERY ‚Üí DELIVERED
POST {{baseUrl}}/api/scan
Content-Type: {{contentType}}
Cookie: {{cookie}}

{
  "ref": "SHP-20251002-0003",
  "status": "DELIVERED",
  "location": "Dakar/Front Desk",
  "note": "Signed by receiver"
}


### 8Ô∏è‚É£ ‚ùå Invalid transition (should 400)
POST {{baseUrl}}/api/scan
Content-Type: {{contentType}}
Cookie: {{cookie}}

{
  "ref": "SHP-20251002-0003",
  "status": "AT_HUB",
  "note": "Attempt backward"
}


### 9Ô∏è‚É£ Verify timeline
GET {{baseUrl}}/api/shipments?status=DELIVERED
Cookie: {{cookie}}

### üîü (Optional) Re-fetch the specific shipment with scans
GET {{baseUrl}}/api/shipments/SHP-20251002-0003/scans
Cookie: {{cookie}}
